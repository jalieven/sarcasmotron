<link rel="import" href="./components/polymer/polymer.html">
<link rel="import" href="./post-service/post-service.html">
<link rel="import" href="sarcasm-card.html">

<polymer-element name="sarcasm-stream" attributes="show">
    <template>
        <style>
            :host {
                display: block;
                width: 100%;
            }
            .context {
                opacity: 0.3;
            }
            sarcasm-card {
                margin-bottom: 30px;
            }
        </style>

        <post-service id="service" posts="{{posts}}"></post-service>

        <div layout vertical center>

            <template repeat="{{post in posts}}">

                <sarcasm-card favorite="{{post.favorite}}" on-favorite-tap="{{handleFavorite}}" hidden?="{{show == 'favorites' && !post.favorite}}">
                    <img src="{{post.avatar}}" width="70" height="70">
                    <h2>{{post.username}}</h2>
                    <p class="context"><b>{{post.timestamp}}</b></p>
                    <p>{{post.sarcasm}}</p>
                    <p class="context" align="right"><i>{{post.context}}</i></p>
                </sarcasm-card>

            </template>

        </div>

    </template>

    <script>
        Polymer({
            handleFavorite: function(event, detail, sender) {
                var post = sender.templateInstance.model.post;
                this.$.service.setFavorite(post.id, post.favorite);
            }
        });
    </script>

</polymer-element>
